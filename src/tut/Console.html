<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>

  <title></title>

</head><body>
  <div class="article">

    <p>The PlotDevice core is now split off from the UI functionality, so you can use it in any
    project. There are a few different ways of using PlotDevice.</p>
    <h2>1. The easy way: from PlotDevice itself</h2>

    <p>One of the new features in PlotDevice is that you can access the canvas object. It’s a
    list-like structure, containing all your graphical objects (’grobs’). The canvas also has a
    ‘save’ method, so anywhere in your script you can do:</p>
<pre>canvas.save("partial.pdf")
</pre>

    <p>And it will save what it has drawn <em>up until that point.</em> Do it at the end of your
    script, and you get the full output.</p>
    <p>After saving, you might want to clear out the canvas. You can:</p>
<pre>canvas.clear()
</pre>

    <p>This will remove all grobs already on the canvas; they will not show up in the render.</p>
    <h2>2. Installing the PlotDevice module</h2>

    <p>If you want to use PlotDevice from the command line, you will have to install it. We currently
    recommend using <a href="http://subversion.tigris.org/" title="Subversion">Subversion</a> to
    grab a copy:</p>
<pre>svn co http://dev.nodebox.net/svn/plotdevice/trunk/ plotdevice
cd libs/Numeric
python setup.py install
cd ../..

cd libs/pathmatics
python setup.py install
cd ../..

cd libs/polymagic
python setup.py install
cd ../..

cd src
python setup.py install
</pre>

    <p>The only outside dependency is <a href="http://pyobjc.sourceforge.net/" title="PyObjC">PyObjC</a>. We recommend the latest version from Subversion.</p>
    <h2>3. Using the console runner</h2>

    <p>When you have a set of PlotDevice scripts that you want to run to generate images or a movie,
    use the following commands:</p>
<pre>from plotdevice import console
source = "size(200,200)\nrect(random(WIDTH), random(HEIGHT), 20, 20)"
console.make_image(source, "rect.png")
console.make_movie(source, "rect.mov", 20, fps=30)
</pre>

    <p>Currently, there is no way to run the console from the command line, but we’re working on
    that.</p>
    <h2>4. Accessing the context directly</h2>

    <p>If you want to have direct access to PlotDevice’s drawing context, you can import everything
    directly. The API remains the same, but you have to prefix everything with the context. Note
    also the initialization of Cocoa, necessary for using the API.</p>
<pre>from AppKit import NSApplication
NSApplication.sharedApplication().activateIgnoringOtherApps_(0)

from plotdevice.graphics import Context
from plotdevice.util import random, choice, grid, files
ctx = Context()
ctx.size(200, 200)
ctx.rect(random(ctx.WIDTH), random(ctx.HEIGHT), 100, 100)
ctx.save("test.png")
</pre>

    <p>You can also make movies this way:</p>
<pre>from AppKit import NSApplication
NSApplication.sharedApplication().activateIgnoringOtherApps_(0)

from plotdevice.graphics import Context
from plotdevice.util import random, choice, grid, files
from plotdevice.util.QTSupport import Movie

movie = Movie("rects.mov")
for i in range(10):
   ctx = Context()
    ctx.size(200, 200)
 ctx.rect(random(ctx.WIDTH), random(ctx.HEIGHT), 100, 100)
  movie.add(ctx)
movie.save()
</pre>

    <h2>5. Drawing in a Cocoa drawRect method</h2>

    <p>If you want to implement your existing drawing using PlotDevice, you can do the following in
    your class’s drawRect: method:</p>
<pre>def drawRect_(self, rect):
    from plotdevice.graphics import Context
   from plotdevice.util import random
    ctx.size(*rect[1])
 ctx.rect(random(ctx.WIDTH), random(ctx.HEIGHT), 100, 100)
  ctx.canvas.draw()
</pre>

    <p>Note that creating the Context and drawing it are two separate steps:</p>
    <ul>
      <li>First, the context is created; all drawing commands are translated into graphic objects
      (’grobs’) that are stored on the canvas.
      </li><li>Then, the canvas is drawn; each grob now renders itself on the current Cocoa graphics
      context.
    </li></ul>

    <p>This also means you can cache the context (or the canvas) and use it in a drawRect method
    during a later stage.</p>





    <h1>Using PlotDevice as a Module</h1>

    <p>Though the <a href="plotdevice.html"><code>plotdevice</code></a> command provides a convenient way
    to launch scripts with the PlotDevice interpreter, you may prefer to use the graphics context and
    export functions from within your own module (and running whichever <code>python</code> binary
    your system or virtualenv provides).</p>
    <p>Detailed installation instructions can be found in the project’s <code><a href="https://github.com/samizdatco/plotdevice-pyobjc/blob/master/README.md">README</a></code> file. To
    simplify the use of PlotDevice with other external libraries, we recommend installing the module
    into a <a href="http://virtualenv.org">virtualenv</a> along with your other dependencies:</p>
    <pre class="shell"><span class="kw">$ </span>virtualenv env
<span class="kw">$ </span>source ./env/bin/activate
<span class="o">(</span>env<span class="o">)</span><span class="kw">$ </span>pip install plotdevice
<span class="o">(</span>env<span class="o">)</span><span class="kw">$ </span>pip install requests envoy bs4 <span class="grey"># some other useful packages</span>
</pre>

    <h2><a href="#plotdevice-star" id="plotdevice-star" name="plotdevice-star"></a>Initializing a graphics context from your script</h2>

    <p>The <code>plotdevice</code> module initializes your script’s namespace with one
    identical to a script running with the app or command line tool. For instance, the following
    will draw a few boxes:</p>
    <pre class="shell"><span class="grey">#!/usr/bin/env python</span>
<span class="kw">from</span> <span class="nn">plotdevice</span> <span class="kw">import</span> <span class="o">*</span>
<span class="kw">for</span> <span class="kw">x</span><span class="s">,</span> <span class="kw">y</span> <span class="ow">in</span> <span class="kw">grid</span><span class="s">(</span><span class="mi">10</span><span class="s">,</span><span class="mi">10</span><span class="s">,</span><span class="mi">12</span><span class="s">,</span><span class="mi">12</span><span class="s">):</span>
    <span class="kw">rect</span><span class="s">(</span><span class="kw">x</span><span class="s">,</span><span class="kw">y</span><span class="s">,</span> <span class="mi">10</span><span class="s">,</span><span class="mi">10</span><span class="s">)</span>
</pre>

    <p>You can then generate output files using the global <code>canvas</code> object. Its
    <code>save</code> method takes a file path as an argument and the format will be determined by
    the file extension (<code>pdf</code>, <code>eps</code>, <code>png</code>, <code>jpg</code>,
    <code>gif</code>, or <code>tiff</code>):</p>
<pre>canvas.save('~/Pictures/output.pdf')
</pre>

    <p>If you’re generating multiple images, be sure to reset the graphics state in between frames:</p>
<pre>canvas.clear()
</pre>

    <p>But if you plan to do more than generate a one-off, you’ll likely find the <a href="../ref/Canvas.html#export()"><code>export()</code></a> function more convenient. It provides
    convenience methods for writing images, vector documents, and even animations.</p>






  </div>




</body></html>